# LLM Chatbot API

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π REST API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏.

## üöÄ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

- **OpenAI** (GPT-4, GPT-3.5)
- **Ollama** (–ª–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏)
- **Mistral AI**
- **Groq**
- **LocalAI** (—Å–∞–º–æ—Ö–æ—Å—Ç–∏–Ω–≥)
- **Google Gemini** (—á–µ—Ä–µ–∑ OpenAI-compatible endpoint)
- **Anthropic Claude** (—á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏)
- –õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ OpenAI-compatible API

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
uv sync
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example`:

```bash
cp env.example .env
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

#### OpenAI (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
```env
LLM_BASE_URL=https://api.openai.com/v1
LLM_MODEL=gpt-4o-mini
LLM_API_KEY=sk-your-openai-api-key
```

#### Ollama (–ª–æ–∫–∞–ª—å–Ω—ã–π)
```env
LLM_BASE_URL=http://localhost:11434/v1
LLM_MODEL=llama3.2
LLM_API_KEY=ollama
```

#### Mistral AI
```env
LLM_BASE_URL=https://api.mistral.ai/v1
LLM_MODEL=mistral-small-latest
LLM_API_KEY=your-mistral-api-key
```

#### Groq
```env
LLM_BASE_URL=https://api.groq.com/openai/v1
LLM_MODEL=llama-3.1-70b-versatile
LLM_API_KEY=your-groq-api-key
```

### 4. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```env
# –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (0.0 - 2.0)
LLM_TEMPERATURE=0.7

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
LLM_MAX_TOKENS=1000

# –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ (—Å–µ–∫—É–Ω–¥—ã)
REQUEST_TIMEOUT=30.0
```

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
just server

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
just test

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
just lint
```

## üìñ API

### POST /question

–û—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞ –∫ LLM –º–æ–¥–µ–ª–∏.

**Request:**
```json
{
  "text": "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?"
}
```

**Response:**
```json
{
  "text": "–ü—Ä–∏–≤–µ—Ç! –£ –º–µ–Ω—è –≤—Å—ë —Ö–æ—Ä–æ—à–æ, —Å–ø–∞—Å–∏–±–æ! –ö–∞–∫ –≤–∞—à–∏ –¥–µ–ª–∞?"
}
```

### Swagger UI

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000/docs`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤:

- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞
- ‚úÖ –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ LLM –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- ‚úÖ –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ retry –ª–æ–≥–∏–∫–∏ –¥–ª—è RateLimitError –∏ InternalServerError
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è retry –¥–ª—è AuthenticationError

## üîÑ Retry –ª–æ–≥–∏–∫–∞

API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö:

- **–ü–æ–≤—Ç–æ—Ä—ã**: –º–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏
- **–ó–∞–¥–µ—Ä–∂–∫–∞**: —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è (1—Å, 2—Å, 4—Å, 8—Å –º–∞–∫—Å)
- **–£—Å–ª–æ–≤–∏—è**: —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `RateLimitError` –∏ `InternalServerError`
- **–ò—Å–∫–ª—é—á–µ–Ω–∏—è**: `AuthenticationError` –∏ –¥—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **FastAPI** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **AsyncOpenAI** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π SDK –¥–ª—è OpenAI API
- **Pydantic** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Tenacity** - —É–º–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- **pytest** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

